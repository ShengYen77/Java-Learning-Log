## ⭐HTTP 方法的「安全性」與「冪等性」概念

# 什麼是「安全(Safe)」?

Safe 表示：該 HTTP 方法 **只用來讀取資料，不會改變伺服器上的資源狀態**。

安全方法：GET、HEAD、OPTIONS

非安全方法：POST、PUT、DELETE

換句話說，如果你不小心按了 F5（重新整理），不該導致資料異動。

這就是安全操作的基本原則。

# 什麼是「冪等(Idempotent)」?

Idempotent 表示：**相同的請求執行一次或多次，伺服器的狀態都會一樣**。

舉例來說：

- DELETE /users/1

  執行一次會刪除用戶 1
  
  執行十次，結果仍是「用戶 1 被刪除」——結果不會變。

- PUT /users/1（帶相同資料）
  
  執行一次或多次，都是把 user 1 的資料更新成相同內容。

| HTTP 方法 | 安全（Safe） | 冪等（Idempotent） | 說明              |
| ------- | -------- | -------------- | --------------- |
| GET     | 是      | 是            | 查詢資料，無副作用       |
| POST    | 否      | 否            | 每次請求可能建立不同資源    |
| PUT     | 否      | 是            | 每次請求會將資料覆蓋成相同狀態 |
| DELETE  | 否      | 是            | 多次刪除請求結果一致      |
| PATCH   | 否      | 否（有時是）       | 視實作而定，通常不被視為冪等  |

補充知識 :

安全 ≠ 不會被記錄！像 GET 請求也可以被記錄或緩存（例如 Google Analytics）。

冪等 ≠ 無副作用！例如 DELETE 雖然是冪等的，但它的副作用（刪除資料）是真實發生的。


# HTTP 狀態碼（Status Code）

當我們發送 HTTP 請求給伺服器（例如透過瀏覽器、Postman 或 Spring Boot 開發的 API Client），伺服器會回傳一個「HTTP 狀態碼（Status Code）」來告訴我們這次請求的結果狀態。

狀態碼是一個 3 位數字，依照「第一個位數」不同，可分為以下 5 大類別：

| 類別  | 範圍      | 說明                        |
| --- | ------- | ------------------------- |
| 1xx | 100–199 | *Informational*：資訊回應（較少用） |
| 2xx | 200–299 | *Success*：成功              |
| 3xx | 300–399 | *Redirection*：重導向         |
| 4xx | 400–499 | *Client Error*：使用者端錯誤     |
| 5xx | 500–599 | *Server Error*：伺服器端錯誤     |

**常見 2xx 成功狀態**

| 狀態碼            | 說明                 |
| -------------- | ------------------ |
| 200 OK         | 一切正常               |
| 201 Created    | 成功建立（多用於 POST）     |
| 204 No Content | 成功但無內容（常見於 DELETE） |

**常見 4xx 使用者端錯誤**

| 狀態碼                    | 說明                    |
| ---------------------- | --------------------- |
| 400 Bad Request        | 請求格式有誤、缺失必要欄位         |
| 401 Unauthorized       | 未授權（通常需登入 token）      |
| 403 Forbidden          | 被拒絕（有權限但被阻擋）          |
| 404 Not Found          | 找不到資源                 |
| 405 Method Not Allowed | HTTP 方法錯誤（如用 GET 去刪除） |

**常見 5xx 伺服器端錯誤**

| 狀態碼                       | 說明       |
| ------------------------- | -------- |
| 500 Internal Server Error | 伺服器內部錯誤  |
| 502 Bad Gateway           | 上游回應錯誤   |
| 503 Service Unavailable   | 服務暫時無法使用 |

小結 : 透過 HTTP 狀態碼 = 伺服器給我們的**回應信號** → 用來判斷請求是成功、失敗還是我們自己寫錯。
